generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum RecipientType {
  INDIVIDUAL
  BUSINESS
}

enum AccountType {
  SAVINGS
  CURRENT
  NRE
  NRO
  OTHER
}

enum TransactionStatus {
  PENDING
  CLAIMED
  FAILED
  EXPIRED
  ON_HOLD
}

model Recipient {
  id              String         @id @default(cuid())
  walletAddress   String
  type            RecipientType
  firstName       String?        @db.VarChar(120)
  lastName        String?        @db.VarChar(120)
  businessName    String?        @db.VarChar(200)
  email           String?        @db.VarChar(160)
  phone           String?        @db.VarChar(60)
  accountNumber   String         @db.VarChar(64)
  ifsc            String         @db.VarChar(20)
  bankName        String         @db.VarChar(160)
  accountHolder   String         @db.VarChar(160)
  branch          String?        @db.VarChar(160)
  accountType     AccountType
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt

  @@index([walletAddress])
}

model Transaction {
  id               String             @id @default(cuid())
  senderWallet     String
  recipientId      String?
  recipientEmail   String?            @db.VarChar(160)
  recipientPhone   String?            @db.VarChar(60)
  status           TransactionStatus  @default(PENDING)
  fromAmount       Decimal            @db.Decimal(18, 2)
  currencyFrom     String             @db.VarChar(10) @default("USD")
  currencyTo       String             @db.VarChar(10) @default("INR")
  notes            String?            @db.Text
  purpose          String             @db.VarChar(280)
  quoteId          String?            @db.VarChar(120)
  quoteSnapshot    Json?
  quoteExpiresAt   DateTime?
  claimExpiresAt   DateTime?
  claimedAt        DateTime?
  gpsTransactionId String?            @db.VarChar(160)
  gpsResponse      Json?
  createdAt        DateTime           @default(now())
  updatedAt        DateTime           @updatedAt

  @@index([recipientId])
  @@index([senderWallet])
  @@index([status])
}
